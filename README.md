## RSSAggregator
Сервис предназначен для сбора новостей с rss-лент. 
Для работы требуется PostgreSQL.  
Все новости и данные о сайте хранятся в БД. Время запуска парсинга ленты задается в виде стандартной cron строки.  
Пример:  
`* * * * *` - обработка будет запускаться каждую минуту  
`*/4 * * * *` - обработка будет запускаться каждые 4 минуты  
`0 * * * *` - обработка будет запускаться раз в час  
При запуске приложения, все задания, которые хранятся в БД будут снова поставлены на выполнение. 

Так же для работы понадобится config.json:  
```json
{
  "dataBase": {
	"host": "127.0.0.1",
	"port": "5432",
	"user": "postgres",
	"dbName": "rss",
	"password": "pass"
	},
  "logLevel": "debug"
}
```

## Models  

Используется 2 вида сущностей Sites - это сайты для добавления задания и Articles - для просмотра новостей  
###Модель Site: 
  ```json
 {
        "id": 11,
        "url": "https://www.drive.ru/rss",
        "cron": "*/4 * * * *",
        "rules": {
            "articleRootName": "",
            "title": "",
            "url": "",
            "description": "",
            "pubDate": ""
        },
        "info": {
            "id": 0,
            "title": "",
            "link": "",
            "description": "",
            "language": ""
        }
    }
```
- url - адрес по которому доступна rss-лента
- cron - расписание по которому нужно выполнять обработку для сайта
- rules - набор правил, по которым происходит маппинг
  + articleRootName - имя узла в котором располагается новость(в основном это item)
  + title - имя поля в котором хранится название новости  
  + link - имя поля в котором хранится ссылка 
  + description - имя поля в котором хранится текст новости
  + pubDate - имя поля в котором хранится дата публикации
- info - объект, который заполняется после первого процесса обработки новостей. Является просто дополнительной информацией к сайту

###Модель Article: 
 ```json
 {
   "id": 41,
   "title": "Facebook анонсировала собственный облачный игровой сервис",
   "link": "https://overclockers.ru/softnews/show/106315/facebook-anonsirovala-sobstvennyj-oblachnyj-igrovoj-servis",
   "description": "Но список игр пока вызывает недоумение. ",
   "pubDate": "2020-10-26T15:42:00+03:00"
 }
 ```
## Routes 
+ ```GET site/?limit={{limit}}&offset={{offset}}``` -  получить список всех сайтов, для которых выполняется обработка ленты. Параметры limit & offset обязательны! 
+ ```GET site/{{siteID}}/``` -  получить полную модель сайта.   

+ ```PUT site/``` -  обновить сайт в БД.
+ ```DELETE site/{{siteID}}/``` -  удалить сайты из БД и остановить его обработку.
+ ```GET site/process/{{siteID}}/``` -  запустить обработку новости для сайта принудительно, не дожидаясь расписания  
+ ```GET site/``` -  добавить новый сайт


+ ```GET article/?limit={{limit}}&offset={{offset}}&title={{title}}``` - получить список статей. limit & offset - обязательны. Title ищет вхождение подстроки в названии статьи  

+ ```GET article/{{id}}``` - получить статью по ID  

### Запуск в автоматическом режиме

- Для запуска приложения достаточно команды: `sudo docker-compose up --build`  
- Http сервер будет доступен на 8585 порту.  
- В репозитории в папке testData лежит 2 json файла с моделями сайтов, которые можно добавить на обработку(роут POST localhost:8585/site/). Первый сайт запускается с периодичностью каждую 4 минуту часа, второй - каждую 6 минуту.

### TODO:
* [ ] unit-тесты
* [ ] перейти на модули
* [ ] добавить больше логов